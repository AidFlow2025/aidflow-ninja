<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Ninja â€” AidFlow Ninja</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../css/main.css" />
</head>

<body>

<!-- ======================
     PROTECCIÃ“N DE RUTA
====================== -->
<script src="../js/auth.js"></script>
<script>
  protegerRuta();
</script>

<!-- ======================
     HEADER
====================== -->
<header class="dashboard-header">
  <div>
    <h1>ðŸ¥· Panel del Ninja</h1>
    <p class="muted" id="ninja-nombre"></p>
  </div>

  <button class="btn secondary" onclick="logout()">
    Cerrar sesiÃ³n
  </button>
</header>

<main class="container dashboard-container">

  <!-- WALLET -->
  <section class="card">
    <h2>ðŸ’° Wallet Ninja</h2>
    <p>
      Saldo disponible:
      <strong>$<span id="wallet-saldo">0.00</span></strong>
    </p>
    <button class="btn primary" onclick="sumarSaldo(10)">
      âž• Simular ingreso $10
    </button>
  </section>

  <!-- REFERIDOS -->
  <section class="card">
    <h2>ðŸ§² Referidos</h2>
    <p>
      Tus referidos:
      <strong id="mis-referidos">0</strong>
    </p>
    <p class="muted">CompartÃ­ este enlace:</p>
    <input type="text" id="link-referido" readonly onclick="this.select()" />
  </section>

  <!-- DOJO -->
  <section class="card">
    <h2>ðŸŽ® Dojo Ninja</h2>
    <p class="muted">Juegos de entrenamiento y torneos</p>
    <button class="btn primary" onclick="abrirDojo()">
      Entrar al Dojo
    </button>
    <div id="zona-juego" style="margin-top:20px;"></div>
  </section>

</main>

<footer class="footer">
  <p>Â© 2025 AidFlow Ninja</p>
  <p>Ayuda mutua Â· MÃ©rito Â· Transparencia</p>
</footer>

<!-- ======================
     SCRIPTS
====================== -->
<script src="../js/wallet.js"></script>
<script src="../js/economia.js"></script>
<script src="../js/dojo.js"></script>

<script>
  const user = localStorage.getItem("aidflow_user");

  document.getElementById("ninja-nombre").textContent =
    "Bienvenido, " + user;

  const refs =
    Number(localStorage.getItem("aidflow_refs_" + user)) || 0;
  document.getElementById("mis-referidos").textContent = refs;

  document.getElementById("link-referido").value =
    window.location.origin + "/register.html?ref=" + user;
</script>

</body>
</html>
