<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard â€” AidFlow Ninja</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/main.css">
</head>
<script src="../js/auth.js"></script>
<script>
  protegerRuta("user");
</script>

<body>

<!-- PROTECCIÃ“N USER -->
<script>
  if (!localStorage.getItem("aidflow_user")) {
    window.location.href = "../login.html";
  }
</script>

<header class="admin-header">
  <div>
    <h1>ğŸ¥· Panel del Ninja</h1>
    <p class="muted">Tu progreso dentro del Dojo</p>
  </div>

  <button class="btn secondary" onclick="logout()">
    Salir
  </button>
</header>

<main class="container admin-container">

  <!-- ======================
       ECONOMÃA
  ======================= -->
  <section class="card">
    <h2>ğŸ’° EconomÃ­a</h2>

    <p>Saldo disponible:</p>
    <p class="big-money" id="saldo">$0.00</p>
  </section>

  <!-- ======================
       REFERIDOS
  ======================= -->
  <section class="card">
    <h2>ğŸ‘¥ Referidos</h2>

    <p>Referidos activos:</p>
    <p class="big-number" id="refs">0</p>

    <label>
      Tu link de referido
      <input type="text" id="ref-link" readonly>
    </label>

    <button class="btn primary" onclick="copiarReferido()">
      Copiar link
    </button>
  </section>

  <!-- ======================
       NIVEL
  ======================= -->
  <section class="card">
    <h2>âš”ï¸ Nivel Ninja</h2>

    <p>
      Nivel actual:
      <strong id="nivel">1</strong>
    </p>

    <p class="muted">
      A mayor nivel, mejores recompensas y velocidad de micropagos
    </p>
  </section>

  <!-- ======================
       JUEGOS
  ======================= -->
  <section class="card locked">
    <h2>ğŸ® Juegos</h2>

    <p id="estado-juegos">
      ğŸ”’ Se desbloquean al alcanzar 100 usuarios activos
    </p>

    <button class="btn secondary" disabled>
      Entrar a Juegos
    </button>
  </section>


  <!-- ======================
     DUELOS NINJA
====================== -->
<section class="card" id="seccion-duelos">
  <h2>âš”ï¸ Duelos Ninja</h2>

  <p id="duelo-status" class="muted">
    Verificando requisitos...
  </p>

  <button
    class="btn primary"
    id="btn-duelo"
    style="display:none;"
    onclick="entrarDuelo()">
    âš”ï¸ Entrar a un Duelo ($0.25)
  </button>
</section>

  <!-- ======================
       TORNEOS
  ======================= -->
  <section class="card locked">
    <h2>ğŸ† Torneos</h2>

    <p id="estado-torneo">
      ğŸ”’ PrÃ³ximamente
    </p>

    <button class="btn secondary" disabled>
      Ver Torneos
    </button>
  </section>
<!-- ======================
     TORNEO ACTIVO
====================== -->
<section class="card" id="seccion-torneo">
  <h2>ğŸ† Torneo Ninja</h2>

  <p id="torneo-estado" class="muted">
    Cargando estado del torneo...
  </p>

  <ul id="torneo-info" style="display:none;">
    <li>ğŸ’° Pozo total: <strong id="torneo-pozo-view">$0</strong></li>
    <li>ğŸ… Ganadores: <strong id="torneo-ganadores-view">0</strong></li>
  </ul>

  <button
    class="btn primary"
    id="btn-torneo-entrar"
    style="display:none;"
    onclick="entrarTorneo()">
    âš”ï¸ Entrar al Torneo
  </button>
</section>

  <!-- ======================
     JUEGOS DEL DOJO
====================== -->
<section class="card" id="seccion-juegos" style="display:none;">
  <h2>ğŸ® Dojo Arcade</h2>

  <p class="muted">
    Juegos de entrenamiento ninja.  
    No otorgan recompensas, solo habilidad.
  </p>

  <div id="juegos-embed" class="games-grid"></div>
</section>

</main>

<footer class="footer">
  <p>Â© 2025 AidFlow Ninja</p>
</footer>

<script>
function logout() {
  localStorage.removeItem("aidflow_user");
  window.location.href = "../login.html";
}

function copiarReferido() {
  const input = document.getElementById("ref-link");
  input.select();
  document.execCommand("copy");
  alert("Link copiado ğŸ¥·");
}
<!-- ======================
     DUELOS NINJA
====================== -->
<section class="card" id="seccion-duelos">
  <h2>âš”ï¸ Duelos Ninja</h2>

  <p id="duelo-status" class="muted">
    Verificando requisitos...
  </p>

  <button
    class="btn primary"
    id="btn-duelo"
    style="display:none;"
    onclick="entrarDuelo()">
    âš”ï¸ Entrar a un Duelo ($0.25)
  </button>
</section>

function cargarDashboard() {
  const user = localStorage.getItem("aidflow_user");

  // Saldo
  const saldo =
    Number(localStorage.getItem("aidflow_saldo_" + user)) || 0;
  document.getElementById("saldo").textContent =
    "$" + saldo.toFixed(2);

  // Nivel
  const nivel =
    localStorage.getItem("aidflow_nivel_" + user) || "1";
  document.getElementById("nivel").textContent = nivel;

  // Referidos
  const refs =
    Number(localStorage.getItem("aidflow_refs_" + user)) || 0;
  document.getElementById("refs").textContent = refs;

  // Link referido
  const link =
    window.location.origin +
    "/register.html?ref=" + user;

  document.getElementById("ref-link").value = link;
}

document.addEventListener("DOMContentLoaded", cargarDashboard);
</script>
<script src="../js/duelos.js"></script>

</body>
</html>
